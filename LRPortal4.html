<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>TheLinkFollower</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Open+Sans:wght@300;400&display=swap');

        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --accent-color: #FFC107;
            --text-color: #333;
            --light-text-color: #f4f4f4;
            --background-light: #f4f4f4;
            --background-dark: #2c3e50;
            --card-background: #ffffff;
            --border-color: #e0e0e0;
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Open Sans', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: var(--background-light);
            color: var(--text-color);
            line-height: 1.6;
        }

        .header {
            background-color: var(--background-dark);
            color: var(--light-text-color);
            padding: 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px var(--shadow-medium);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding-left: 5%;
            padding-right: 5%;
        }

        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8em;
            font-weight: 700;
            color: var(--accent-color);
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
            cursor: pointer; /* Add cursor pointer to indicate it's clickable */
        }

        .nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .nav ul li {
            margin-left: 30px;
        }

        .nav ul li a {
            color: var(--light-text-color);
            text-decoration: none;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 1.05em;
            transition: color 0.3s ease, transform 0.2s ease;
        }

        .nav ul li a:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        main {
            padding: 20px 5%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 80px 40px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 40px;
            box-shadow: 0 8px 20px var(--shadow-medium);
        }

        .hero h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 3.5em;
            margin-bottom: 15px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .hero p {
            font-size: 1.4em;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
            font-family: 'Open Sans', sans-serif;
        }

        .categories,
        .disclaimer,
        .legal,
        .auth-section,
        .admin-panel {
            background-color: var(--card-background);
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px var(--shadow-light);
            margin-bottom: 30px;
        }

        h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        h2::after {
            content: '';
            width: 80px;
            height: 4px;
            background-color: var(--accent-color);
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }

        .search-container {
            display: flex;
            justify-content: center;
            margin-bottom: 50px;
            gap: 15px;
        }

        .search-container input[type="text"] {
            padding: 12px 20px;
            width: 70%;
            max-width: 500px;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 3px var(--shadow-light);
        }

        .search-container input[type="text"]:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
            outline: none;
        }

        .search-container button {
            padding: 12px 25px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px var(--shadow-light);
        }

        .search-container button:hover {
            background-color: #1976D2;
            transform: translateY(-2px);
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .category {
            background-color: var(--card-background);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 15px var(--shadow-light);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .category:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px var(--shadow-medium);
        }

        .category h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.7em;
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }

        .category ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .category ul li {
            margin-bottom: 12px;
            display: flex;
            align-items: center;
        }

        .category ul li:last-child {
            margin-bottom: 0;
        }

        .category ul li a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 1.05em;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
        }

        .category ul li a::before {
            content: 'üîó';
            margin-right: 10px;
            color: var(--secondary-color);
            font-size: 0.9em;
            transition: transform 0.2s ease;
        }

        .category ul li a.download-link::before {
            content: '‚¨áÔ∏è';
            color: var(--primary-color);
        }

        .category ul li a:hover {
            color: var(--secondary-color);
        }

        .category ul li a:hover::before {
            transform: rotate(15deg);
        }

        .category-separator {
            height: 5px;
            border: none;
            margin: 50px auto;
            border-radius: 5px;
            box-shadow: 0 3px 10px var(--shadow-light);
            width: 80%;
            max-width: 600px;
        }

        .category-separator.grade1 {
            background: linear-gradient(to right, #a18cd1 0%, #fbc2eb 100%);
        }

        .category-separator.grade2 {
            background: linear-gradient(to right, #fad0c4 0%, #ffd1ff 100%);
        }

        .category-separator.grade3 {
            background: linear-gradient(to right, #ffecd2 0%, #fcb69f 100%);
        }

        .category-separator.grade4 {
            background: linear-gradient(to right, #ff9a9e 0%, #fecfef 100%);
        }

        .category-separator.grade5 {
            background: linear-gradient(to right, #a1c4fd 0%, #c2e9fb 100%);
        }

        .category-separator.grade6 {
            background: linear-gradient(to right, #fedfef 0%, #ace0f9 100%);
        }

        .category-separator.grade7 {
            background: linear-gradient(to right, #fdcbf1 0%, #e6dee9 100%);
        }

        .category-separator.grade8 {
            background: linear-gradient(to right, #d4fc79 0%, #96e6a1 100%);
        }

        .category-separator.grade9 {
            background: linear-gradient(to right, #84fab0 0%, #8fd3f4 100%);
        }

        .category-separator.grade10 {
            background: linear-gradient(to right, #cfd9ed 0%, #e2e7f6 100%);
        }

        .category-separator.grade11 {
            background: linear-gradient(to right, #c79081 0%, #dfa579 100%);
        }

        .category-separator.grade12 {
            background: linear-gradient(to right, #fddb92 0%, #d1fdff 100%);
        }

        .disclaimer,
        .legal {
            text-align: center;
            padding: 30px;
            background-color: var(--background-dark);
            color: var(--light-text-color);
            box-shadow: 0 4px 15px var(--shadow-medium);
            border-radius: 10px;
        }

        .disclaimer h2,
        .legal h2 {
            color: var(--accent-color);
        }

        .disclaimer p,
        .legal p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .footer {
            background-color: var(--background-dark);
            color: var(--light-text-color);
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            box-shadow: 0 -2px 10px var(--shadow-medium);
        }

        .footer p {
            margin: 0;
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Admin Panel Styles */
        .auth-section, .admin-panel {
            display: none; /* Hidden by default */
            margin-top: 40px;
        }

        .auth-section h2, .admin-panel h2 {
            color: var(--secondary-color);
        }

        .auth-form, .add-link-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }

        .auth-form input, .add-link-form input, .add-link-form select, .add-link-form textarea {
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1em;
        }

        .auth-form button, .add-link-form button {
            padding: 12px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .auth-form button:hover, .add-link-form button:hover {
            background-color: #45a049;
        }

        .auth-message, .admin-message {
            text-align: center;
            margin-top: 15px;
            font-weight: 600;
            color: red;
        }

        .admin-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .admin-controls button {
            padding: 10px 20px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .admin-controls button:hover {
            background-color: #1976D2;
        }

        .user-id-display {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9em;
            color: #666;
        }

        /* Responsive adjustments for admin panel */
        @media (max-width: 768px) {
            .auth-form, .add-link-form {
                max-width: 100%;
                padding: 0 15px;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="logo" id="mainLogo">TheLinkFollower</div>
        <nav class="nav">
            <ul>
                <li><a href="#categories">Categories</a></li>
                <li><a href="#disclaimer">Disclaimer</a></li>
                <li><a href="#legal">Legal</a></li>
                <li><a href="#" id="adminLoginLink">Admin Login</a></li>
                <li id="adminLogoutLink" style="display: none;"><a href="#">Logout</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="hero" class="hero">
            <h1>Welcome to TheLinkFollower</h1>
            <p>Unearth the Web's Best Educational Resources.</p>
        </section>

        <section id="authSection" class="auth-section">
            <h2>Admin Login</h2>
            <form id="loginForm" class="auth-form">
                <input type="email" id="loginEmail" placeholder="Email" required />
                <input type="password" id="loginPassword" placeholder="Password" required />
                <button type="submit">Login</button>
                <p id="authMessage" class="auth-message"></p>
            </form>
        </section>

        <section id="adminPanel" class="admin-panel">
            <h2>Admin Panel: Add New Educational Material</h2>
            <p class="user-id-display">Logged in as: <span id="currentUserId"></span></p>
            <form id="addLinkForm" class="add-link-form">
                <input type="text" id="fileLink" placeholder="Google Drive File Link (e.g., view link)" required />
                <input type="text" id="linkDescription" placeholder="Description (e.g., 'Math Worksheet')" required />
                <select id="gradeLevel" required>
                    <option value="">Select Grade Level</option>
                    <option value="grade1">Grade 1</option>
                    <option value="grade2">Grade 2</option>
                    <option value="grade3">Grade 3</option>
                    <option value="grade4">Grade 4</option>
                    <option value="grade5">Grade 5</option>
                    <option value="grade6">Grade 6</option>
                    <option value="grade7">Grade 7</option>
                    <option value="grade8">Grade 8</option>
                    <option value="grade9">Grade 9</option>
                    <option value="grade10">Grade 10</option>
                    <option value="grade11">Grade 11</option>
                    <option value="grade12">Grade 12</option>
                </select>
                <button type="submit">Add Link</button>
                <p id="adminMessage" class="admin-message"></p>
            </form>
            <div class="admin-controls">
                <button id="refreshLinks">Refresh Links</button>
            </div>
        </section>

        <section id="categories" class="categories">
            <h2>Browse by Grade Level</h2>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search for subjects or resources..." />
                <button id="searchButton">Search</button>
            </div>
            <div class="category-grid" id="categoryGrid">
                <!-- Categories will be dynamically loaded here by JavaScript -->
                <div class="category" data-category="grade1" style="display: none;">
                    <h3>Grade 1</h3>
                    <ul id="grade1-links"></ul>
                </div>
                <hr class="category-separator grade1" style="display: none;" />

                <div class="category" data-category="grade2" style="display: none;">
                    <h3>Grade 2</h3>
                    <ul id="grade2-links"></ul>
                </div>
                <hr class="category-separator grade2" style="display: none;" />

                <div class="category" data-category="grade3" style="display: none;">
                    <h3>Grade 3</h3>
                    <ul id="grade3-links"></ul>
                </div>
                <hr class="category-separator grade3" style="display: none;" />

                <div class="category" data-category="grade4" style="display: none;">
                    <h3>Grade 4</h3>
                    <ul id="grade4-links"></ul>
                </div>
                <hr class="category-separator grade4" style="display: none;" />

                <div class="category" data-category="grade5" style="display: none;">
                    <h3>Grade 5</h3>
                    <ul id="grade5-links"></ul>
                </div>
                <hr class="category-separator grade5" style="display: none;" />

                <div class="category" data-category="grade6" style="display: none;">
                    <h3>Grade 6</h3>
                    <ul id="grade6-links"></ul>
                </div>
                <hr class="category-separator grade6" style="display: none;" />

                <div class="category" data-category="grade7" style="display: none;">
                    <h3>Grade 7</h3>
                    <ul id="grade7-links"></ul>
                </div>
                <hr class="category-separator grade7" style="display: none;" />

                <div class="category" data-category="grade8" style="display: none;">
                    <h3>Grade 8</h3>
                    <ul id="grade8-links"></ul>
                </div>
                <hr class="category-separator grade8" style="display: none;" />

                <div class="category" data-category="grade9" style="display: none;">
                    <h3>Grade 9</h3>
                    <ul id="grade9-links"></ul>
                </div>
                <hr class="category-separator grade9" style="display: none;" />

                <div class="category" data-category="grade10" style="display: none;">
                    <h3>Grade 10</h3>
                    <ul id="grade10-links"></ul>
                </div>
                <hr class="category-separator grade10" style="display: none;" />

                <div class="category" data-category="grade11" style="display: none;">
                    <h3>Grade 11</h3>
                    <ul id="grade11-links"></ul>
                </div>
                <hr class="category-separator grade11" style="display: none;" />

                <div class="category" data-category="grade12" style="display: none;">
                    <h3>Grade 12</h3>
                    <ul id="grade12-links"></ul>
                </div>
                <hr class="category-separator grade12" style="display: none;" />

            </div>
        </section>

        <section id="disclaimer" class="disclaimer">
            <h2>Disclaimer</h2>
            <p>We do not own any of the listed websites. They are provided as links for informational purposes only.</p>
        </section>

        <section id="legal" class="legal">
            <h2>Legal</h2>
            <p>All links provided are for educational and informational purposes only.</p>
        </section>
    </main>

    <footer class="footer">
        <p>¬© <span id="currentYear"></span> TheLinkFollower</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        document.getElementById("currentYear").textContent = new Date().getFullYear();

        // Firebase configuration (provided by user)
        const firebaseConfig = {
            apiKey: "AIzaSyArVK4JdqGYYMk2rlOLcwenCBzJIWOVYg8",
            authDomain: "igacoslr.firebaseapp.com",
            projectId: "igacoslr",
            storageBucket: "igacoslr.firebasestorage.app",
            messagingSenderId: "168499425895",
            appId: "1:168499425895:web:1e32d9d1c8f52887f0dac2"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Global variables for Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        const authSection = document.getElementById('authSection');
        const adminPanel = document.getElementById('adminPanel');
        const loginForm = document.getElementById('loginForm');
        const loginEmail = document.getElementById('loginEmail');
        const loginPassword = document.getElementById('loginPassword');
        const authMessage = document.getElementById('authMessage');
        const adminLoginLink = document.getElementById('adminLoginLink');
        const adminLogoutLink = document.getElementById('adminLogoutLink');
        const currentUserId = document.getElementById('currentUserId');
        const mainLogo = document.getElementById('mainLogo'); // Get the main logo element

        const addLinkForm = document.getElementById('addLinkForm');
        const fileLinkInput = document.getElementById('fileLink');
        const linkDescriptionInput = document.getElementById('linkDescription');
        const gradeLevelSelect = document.getElementById('gradeLevel');
        const adminMessage = document.getElementById('adminMessage');
        const refreshLinksButton = document.getElementById('refreshLinks');

        const searchInput = document.getElementById("searchInput");
        const categoryGrid = document.getElementById("categoryGrid");
        const categoryElements = document.querySelectorAll(".category");
        const gradeLevelLinkLists = {};
        for (let i = 1; i <= 12; i++) {
            gradeLevelLinkLists[`grade${i}-links`] = document.getElementById(`grade${i}-links`);
        }

        let currentUserIdValue = null;

        // Function to update UI based on authentication state
        const updateUI = (user) => {
            if (user) {
                currentUserIdValue = user.uid;
                currentUserId.textContent = user.uid;
                adminLoginLink.style.display = 'none';
                adminLogoutLink.style.display = 'block';
                authSection.style.display = 'none';
                adminPanel.style.display = 'block'; // Show admin panel if logged in
            } else {
                currentUserIdValue = null;
                currentUserId.textContent = 'Not logged in';
                adminLoginLink.style.display = 'block';
                adminLogoutLink.style.display = 'none';
                authSection.style.display = 'none'; // Hide login form by default
                adminPanel.style.display = 'none'; // Hide admin panel
            }
        };

        // Authenticate user on load
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                updateUI(user);
            } else {
                if (initialAuthToken) {
                    try {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } catch (error) {
                        console.error("Error signing in with custom token:", error);
                        // Fallback to anonymous sign-in if custom token fails
                        try {
                            await signInAnonymously(auth);
                        } catch (anonError) {
                            console.error("Error signing in anonymously:", anonError);
                            updateUI(null); // Show as not logged in
                        }
                    }
                } else {
                    try {
                        await signInAnonymously(auth);
                    } catch (error) {
                        console.error("Error signing in anonymously:", error);
                        updateUI(null); // Show as not logged in
                    }
                }
            }
        });

        // Admin Login Link Click
        adminLoginLink.addEventListener('click', (e) => {
            e.preventDefault();
            authSection.style.display = 'block';
            adminPanel.style.display = 'none';
            authMessage.textContent = '';
        });

        // Admin Logout Link Click
        adminLogoutLink.addEventListener('click', async (e) => {
            e.preventDefault();
            try {
                await signOut(auth);
                authMessage.textContent = 'Logged out successfully.';
                updateUI(null);
            } catch (error) {
                authMessage.textContent = `Logout failed: ${error.message}`;
                console.error("Logout error:", error);
            }
        });

        // Login Form Submission
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = loginEmail.value;
            const password = loginPassword.value;

            try {
                await signInWithEmailAndPassword(auth, email, password);
                authMessage.textContent = 'Login successful!';
                loginForm.reset();
                // UI update handled by onAuthStateChanged listener
            } catch (error) {
                authMessage.textContent = `Login failed: ${error.message}`;
                console.error("Login error:", error);
            }
        });

        // Add Link Form Submission
        addLinkForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const link = fileLinkInput.value;
            const description = linkDescriptionInput.value;
            const grade = gradeLevelSelect.value;

            if (!link || !description || !grade) {
                adminMessage.textContent = 'All fields are required!';
                return;
            }

            try {
                const materialsCollectionRef = collection(db, `artifacts/${appId}/public/data/educationalMaterials`);
                await addDoc(materialsCollectionRef, {
                    link: link,
                    description: description,
                    gradeLevel: grade,
                    createdAt: serverTimestamp(),
                    addedBy: currentUserIdValue // Store who added the link
                });
                adminMessage.textContent = 'Link added successfully!';
                addLinkForm.reset();
            } catch (error) {
                adminMessage.textContent = `Error adding link: ${error.message}`;
                console.error("Error adding document:", error);
            }
        });

        // Function to fetch and display links
        const fetchAndDisplayLinks = () => {
            const materialsCollectionRef = collection(db, `artifacts/${appId}/public/data/educationalMaterials`);
            const q = query(materialsCollectionRef, orderBy('createdAt', 'desc'));

            onSnapshot(q, (snapshot) => {
                // Clear existing links
                for (let i = 1; i <= 12; i++) {
                    gradeLevelLinkLists[`grade${i}-links`].innerHTML = '';
                    document.querySelector(`.category[data-category="grade${i}"]`).style.display = 'none';
                    document.querySelector(`.category-separator.grade${i}`).style.display = 'none';
                }

                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const grade = data.gradeLevel;
                    const link = data.link;
                    const description = data.description;

                    if (gradeLevelLinkLists[grade + '-links']) {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = link;
                        a.target = '_blank';
                        a.textContent = description;
                        a.classList.add('download-link'); // Apply download icon style
                        li.appendChild(a);
                        gradeLevelLinkLists[grade + '-links'].appendChild(li);

                        // Show the category and its separator if it has links
                        document.querySelector(`.category[data-category="${grade}"]`).style.display = 'flex';
                        document.querySelector(`.category-separator.${grade}`).style.display = 'block';
                    }
                });
                // After loading all, apply search filter if any
                performSearch();
            }, (error) => {
                console.error("Error fetching documents:", error);
            });
        };

        // Real-time search functionality
        const performSearch = () => {
            const searchTerm = searchInput.value.toLowerCase();
            categoryElements.forEach(category => {
                let found = false;
                const categoryH3 = category.querySelector('h3');
                if (categoryH3 && categoryH3.textContent.toLowerCase().includes(searchTerm)) {
                    found = true;
                }

                const links = category.querySelectorAll("li a");
                let anyLinkMatches = false;
                links.forEach(link => {
                    if (link.textContent.toLowerCase().includes(searchTerm)) {
                        anyLinkMatches = true;
                    }
                });

                if (found || anyLinkMatches) {
                    category.style.display = "flex";
                    const separator = category.nextElementSibling;
                    if (separator && separator.classList.contains("category-separator")) {
                        separator.style.display = "block";
                    }
                } else {
                    category.style.display = "none";
                    const separator = category.nextElementSibling;
                    if (separator && separator.classList.contains("category-separator")) {
                        separator.style.display = "none";
                    }
                }
            });
        };

        // Event listener for the main logo to refresh the page
        mainLogo.addEventListener('click', () => {
            location.reload(); // Reloads the page, which will re-fetch and display all links
        });

        // Call fetchAndDisplayLinks unconditionally after initial auth state is processed
        // This ensures all users see the content.
        document.addEventListener("DOMContentLoaded", () => {
            fetchAndDisplayLinks();
        });

        searchInput.addEventListener("input", performSearch);
        refreshLinksButton.addEventListener('click', fetchAndDisplayLinks); // Manual refresh for admin
    </script>
</body>

</html>
